@model MonAmour.ViewModels.BlogIndexViewModel
@{
    ViewData["Title"] = "Blog - MonAmour";
}

<div class="min-h-screen" style="background-color: #fbf1e6;">

    <!-- Search Section -->
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-md mx-auto mb-8">
            <form method="post" action="@Url.Action("Search", "Blog")">
                <div class="relative">
                    <input type="text" name="searchTerm" placeholder="Tìm kiếm bài viết..."
                           class="w-full px-4 py-3 rounded-full border border-gray-300 focus:outline-none focus:border-[#62000d] bg-white"
                           value="@Model.SearchTerm">
                    <button type="submit" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-[#62000d]">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </button>
                </div>
            </form>
        </div>

        <!-- Filter Buttons -->
        <div class="flex flex-wrap justify-center gap-4 mb-8">
            <button class="px-6 py-2 rounded-full border border-gray-300 bg-white hover:bg-[#62000d] hover:text-white transition-colors filter-btn" data-filter="new">
                Lọc theo mới
            </button>
            <button class="px-6 py-2 rounded-full border border-gray-300 bg-white hover:bg-[#62000d] hover:text-white transition-colors filter-btn" data-filter="time">
                Lọc theo thời gian
            </button>
            <button class="px-6 py-2 rounded-full border border-gray-300 bg-white hover:bg-[#62000d] hover:text-white transition-colors filter-btn" data-filter="type">
                Lọc theo loại
            </button>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 mb-12">
            <!-- Featured Post - Takes up 3 columns -->
            <div class="lg:col-span-7">
                <h3 class="text-lg font-medium mb-6 text-gray-700" style="font-family: 'Noto Serif', serif;">Bài viết nổi bật</h3>
                @if (Model.FeaturedPosts.Any())
                {
                    var featured = Model.FeaturedPosts.First();
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden cursor-pointer hover:shadow-xl transition-shadow" 
                         onclick="openBlogDetail(@featured.BlogId)">
                        <div class="h-[350px] bg-gray-200 flex items-center justify-center">
                            @if (!string.IsNullOrEmpty(featured.FeaturedImage))
                            {
                                <img src="@featured.FeaturedImage" alt="@featured.Title" class="w-full h-full object-cover">
                            }
                            else
                            {
                                <div class="w-full h-full bg-gray-200 flex items-center justify-center">
                                    <span class="text-gray-400 text-sm uppercase">@featured.CategoryName</span>
                                </div>
                            }
                        </div>
                        <div class="p-8">
                            <div class="flex items-center text-sm text-gray-500 mb-3">
                                <span>@featured.CategoryName</span>
                                <span class="mx-2">•</span>
                                <span>@featured.PublishedDate?.ToString("dd/MM/yyyy")</span>
                                @if (featured.ReadTime > 0)
                                {
                                    <span class="mx-2">•</span>
                                    <span>@featured.ReadTime phút đọc</span>
                                }
                            </div>
                            <h2 class="text-2xl font-bold mb-4 text-gray-800" style="font-family: 'Prata', serif;">
                                @featured.Title
                            </h2>
                            <p class="text-gray-600 leading-relaxed line-clamp-3 text-base" style="font-family: 'Noto Serif', serif;">
                                @featured.Excerpt
                            </p>
                        </div>
                    </div>
                }
            </div>

            <!-- Side Posts - Takes up 2 columns, arranged in 2x2 grid -->
            <div class="lg:col-span-5 mt-8 lg:mt-0">
                <div class="grid grid-cols-2 mt-[50px] gap-6">
                    @foreach (var post in Model.RecentPosts)
                    {
                        <div class="bg-white rounded-lg shadow-md overflow-hidden cursor-pointer hover:shadow-lg transition-shadow" 
                             onclick="openBlogDetail(@post.BlogId)">
                            <div class="bg-gray-200 flex items-center justify-center h-[150px]">
                                @if (!string.IsNullOrEmpty(post.FeaturedImage))
                                {
                                    <img src="@post.FeaturedImage" alt="@post.Title" class="w-full h-full object-cover">
                                }
                                else
                                {
                                    <span class="text-gray-400 text-sm uppercase">@post.CategoryName</span>
                                }
                            </div>
                            <div class="p-5">
                                <div class="flex items-center text-xs text-gray-500 mb-2">
                                    <span>@post.CategoryName</span>
                                    @if (post.ReadTime > 0)
                                    {
                                        <span class="mx-2">•</span>
                                        <span>@post.ReadTime phút</span>
                                    }
                                </div>
                                <h3 class="font-semibold text-gray-800 text-base mb-3" style="font-family: 'Prata', serif;">
                                    @post.Title
                                </h3>
                                <p class="text-gray-600 text-sm leading-relaxed line-clamp-2" style="font-family: 'Noto Serif', serif;">
                                    @post.Excerpt
                                </p>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>

        <!-- Divider Line -->
        <div class="w-full my-8">
            <hr class="border-t-2 border-gray-200">
        </div>

        <!-- Daily Posts Section -->
        <div class="mb-12">
            <h2 class="text-2xl font-bold text-center mb-8 text-gray-800" style="font-family: 'Prata', serif;">
                BÀI MỚI MỖI NGÀY
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                @foreach (var post in Model.DailyPosts)
                {
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden cursor-pointer hover:shadow-xl transition-shadow" 
                         onclick="openBlogDetail(@post.BlogId)">
                        <div class="aspect-video bg-gray-200 flex items-center justify-center">
                            @if (!string.IsNullOrEmpty(post.FeaturedImage))
                            {
                                <img src="@post.FeaturedImage" alt="@post.Title" class="w-full h-full object-cover">
                            }
                            else
                            {
                                <div class="w-full h-full bg-gray-200 flex items-center justify-center">
                                    <span class="text-gray-400 text-sm uppercase">@post.CategoryName</span>
                                </div>
                            }
                        </div>
                        <div class="p-6">
                            <div class="flex items-center text-sm text-gray-500 mb-3">
                                <span>@post.CategoryName</span>
                                <span class="mx-2">•</span>
                                <span>@post.PublishedDate?.ToString("dd/MM/yyyy")</span>
                            </div>
                            <h3 class="text-lg font-bold mb-3 text-gray-800" style="font-family: 'Prata', serif;">
                                @post.Title
                            </h3>
                            <p class="text-gray-600 text-sm leading-relaxed mb-4 line-clamp-3" style="font-family: 'Noto Serif', serif;">
                                @post.Excerpt
                            </p>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>

</div>

<script>
    function openBlogDetail(id) {
        window.location.href = '/Blog/Detail/' + id;
    }

    // Filter functionality
    document.addEventListener('DOMContentLoaded', function() {
        const filterButtons = document.querySelectorAll('.filter-btn');

        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Remove active class from all buttons
                filterButtons.forEach(btn => {
                    btn.classList.remove('bg-[#62000d]', 'text-white');
                    btn.classList.add('bg-white');
                });

                // Add active class to clicked button
                this.classList.add('bg-[#62000d]', 'text-white');
                this.classList.remove('bg-white');

                // Implement the actual filtering logic
                const filter = this.getAttribute('data-filter');
                window.location.href = '/Blog?filter=' + filter;
            });
        });
    });
</script>
