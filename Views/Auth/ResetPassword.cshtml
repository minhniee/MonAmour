@using Microsoft.AspNetCore.Mvc.TagHelpers
@model Mon_Amour.Controllers.ResetPasswordViewModel
@{
    ViewData["Title"] = "Đặt lại mật khẩu";
    ViewData["Subtitle"] = "Tạo mật khẩu mới cho tài khoản của bạn";
    Layout = "~/Views/Shared/_AuthLayout.cshtml";
}

@if (ViewBag.IsSuccess == true)
{
    <div class="text-center space-y-6">
        <div class="mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center">
            <svg class="w-8 h-8 text-green-600" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        </div>

        <p class="text-foreground">
            Mật khẩu của bạn đã được đặt lại thành công. Bạn có thể đăng nhập với mật khẩu mới.
        </p>

        <a href="/Auth/Login" class="w-full inline-flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-primary-foreground bg-primary hover:bg-primary/90">
            Đăng nhập ngay
        </a>
    </div>
}
else
{
    <form asp-action="ResetPassword" method="post" class="space-y-6">
        <div asp-validation-summary="ModelOnly" class="text-destructive text-sm"></div>
        <input asp-for="Token" type="hidden" />

        <div>
            <label asp-for="Password" class="block text-sm font-medium text-foreground">Mật khẩu mới</label>
            <div class="relative mt-1">
                <input asp-for="Password" type="password" id="password" class="block w-full px-3 py-2 pr-10 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary" placeholder="Nhập mật khẩu mới" />
                <button type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center" onclick="togglePassword('password', 'password-icon')">
                    <svg id="password-icon" class="h-4 w-4 text-muted-foreground" fill="none" viewBox="0 0 24 24">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                </button>
            </div>
            <span asp-validation-for="Password" class="mt-1 text-sm text-destructive"></span>
        </div>

        <div>
            <label asp-for="ConfirmPassword" class="block text-sm font-medium text-foreground">Xác nhận mật khẩu mới</label>
            <div class="relative mt-1">
                <input asp-for="ConfirmPassword" type="password" id="confirmPassword" class="block w-full px-3 py-2 pr-10 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary" placeholder="Nhập lại mật khẩu mới" />
                <button type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center" onclick="togglePassword('confirmPassword', 'confirm-password-icon')">
                    <svg id="confirm-password-icon" class="h-4 w-4 text-muted-foreground" fill="none" viewBox="0 0 24 24">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                </button>
            </div>
            <span asp-validation-for="ConfirmPassword" class="mt-1 text-sm text-destructive"></span>
        </div>

        <div class="bg-muted/50 p-4 rounded-lg">
            <h4 class="text-sm font-medium text-foreground mb-2">Yêu cầu mật khẩu:</h4>
            <ul class="text-xs text-muted-foreground space-y-1">
                <li>• Ít nhất 8 ký tự</li>
                <li>• Chứa ít nhất 1 chữ hoa</li>
                <li>• Chứa ít nhất 1 chữ thường</li>
                <li>• Chứa ít nhất 1 số</li>
            </ul>
        </div>

        <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-primary-foreground bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
            Cập nhật mật khẩu
        </button>

        <div class="text-center">
            <a href="/Auth/Login" class="text-sm text-muted-foreground hover:text-foreground">Quay lại đăng nhập</a>
        </div>
    </form>
}
